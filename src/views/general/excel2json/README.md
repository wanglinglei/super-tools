# Excel 转 JSON 工具

功能强大的在线 Excel 转 JSON 工具，支持自定义选择需要转换的字段。

## 功能特性

### 1. 文件支持
- ✅ 支持 .xlsx 格式
- ✅ 支持 .xls 格式
- ✅ 支持 .csv 格式
- ✅ 拖拽上传或点击选择
- ✅ 文件信息显示

### 2. 字段选择
- ✅ 自动识别所有字段
- ✅ 复选框选择字段
- ✅ 全选/取消全选
- ✅ 实时统计已选字段
- ✅ 默认全选所有字段

### 3. 数据预览
- ✅ 显示前 5 行数据
- ✅ 表格形式展示
- ✅ 根据选中字段动态更新
- ✅ 支持横向滚动查看更多字段

### 4. JSON 输出
- ✅ 实时转换
- ✅ 格式化显示（美化）
- ✅ 压缩显示（单行）
- ✅ 语法高亮
- ✅ 一键切换格式

### 5. 统计信息
- 📊 数据行数统计
- 📊 字段数统计
- 📊 文件大小显示

### 6. 导出功能
- ✅ 复制 JSON 到剪贴板
- ✅ 下载为 .json 文件
- ✅ 自动命名（原文件名 + 时间戳）

## 使用说明

### 基础使用流程

1. **上传 Excel 文件**
   - 点击"上传 Excel"按钮
   - 或点击左侧面板的"选择文件"
   - 选择 Excel 文件（.xlsx/.xls/.csv）

2. **选择要转换的字段**
   - 查看"选择要转换的字段"区域
   - 勾选需要的字段
   - 使用"全选"/"取消"快捷按钮

3. **查看数据预览**
   - 在"数据预览"区域查看前 5 行数据
   - 确认数据是否正确

4. **转换为 JSON**
   - 点击"转换为 JSON"按钮
   - 或字段选择后自动转换
   - 右侧显示 JSON 结果

5. **导出使用**
   - 点击"复制 JSON"复制到剪贴板
   - 点击"下载 JSON"保存为文件

### 高级功能

#### 切换 JSON 格式
- **格式化**：美化显示，便于阅读
  ```json
  [
    {
      "name": "张三",
      "age": 25
    }
  ]
  ```
- **压缩**：单行显示，体积更小
  ```json
  [{"name":"张三","age":25}]
  ```

#### 字段筛选
- 可以只选择需要的字段进行转换
- 减少不必要的数据
- 优化输出文件大小

#### 更换文件
- 点击文件信息卡片右上角的"更换"按钮
- 无需清空即可直接上传新文件

## 技术实现

### Excel 解析
```typescript
import * as XLSX from 'xlsx';

// 读取文件
const data = await file.arrayBuffer();
const workbook = XLSX.read(data);

// 获取第一个工作表
const worksheet = workbook.Sheets[workbook.SheetNames[0]];

// 转换为 JSON
const jsonData = XLSX.utils.sheet_to_json(worksheet);
```

### 字段过滤
```typescript
// 只保留选中的字段
const filteredData = excelData.map(row => {
  const newRow: any = {};
  selectedFields.forEach(field => {
    newRow[field] = row[field];
  });
  return newRow;
});
```

### JSON 格式化
```typescript
// 格式化输出
JSON.stringify(data, null, 2); // 缩进 2 个空格

// 压缩输出
JSON.stringify(data); // 无缩进
```

## UI 设计

### 布局结构
- **左侧**：Excel 数据预览与字段选择
  - 文件信息卡片
  - 字段选择区（复选框）
  - 数据预览表格
- **右侧**：JSON 输出与操作
  - JSON 代码显示
  - 统计信息卡片
  - 快捷操作按钮

### 视觉特点
- **卡片式设计** - 清晰的功能分区
- **表格预览** - 直观的数据展示
- **代码高亮** - 深色背景的代码显示
- **统计卡片** - 渐变背景的数据统计

### 交互特点
- 文件上传后自动解析
- 字段选择后自动转换
- 实时预览数据变化
- 一键复制/下载

## 使用场景

1. **数据导入** - 将 Excel 数据导入到系统
2. **API 测试** - 快速生成测试数据
3. **数据迁移** - Excel 数据转换为 JSON 格式
4. **前端开发** - 生成 Mock 数据
5. **数据分析** - 转换为便于处理的格式
6. **配置文件** - Excel 配置转为 JSON
7. **数据清洗** - 选择需要的字段导出

## Excel 格式要求

### 推荐格式
- **第一行为表头**：字段名称
- **从第二行开始为数据**：实际数据行
- **无合并单元格**：避免解析错误
- **无复杂公式**：只保留计算结果

### 示例 Excel 结构
```
| 姓名   | 年龄 | 城市   | 职业     |
|--------|------|--------|----------|
| 张三   | 25   | 北京   | 工程师   |
| 李四   | 30   | 上海   | 设计师   |
| 王五   | 28   | 深圳   | 产品经理 |
```

### 输出 JSON 格式
```json
[
  {
    "姓名": "张三",
    "年龄": 25,
    "城市": "北京",
    "职业": "工程师"
  },
  {
    "姓名": "李四",
    "年龄": 30,
    "城市": "上海",
    "职业": "设计师"
  },
  {
    "姓名": "王五",
    "年龄": 28,
    "城市": "深圳",
    "职业": "产品经理"
  }
]
```

## 常见问题

### 1. 为什么有些字段没有显示？
- Excel 中的空列不会被识别为字段
- 确保第一行有完整的表头

### 2. 日期格式为什么是数字？
- Excel 的日期以数字形式存储
- 可以在 Excel 中先格式化为文本再导入

### 3. 如何处理大文件？
- 工具在浏览器中运行，受内存限制
- 建议单个文件不超过 10MB
- 大文件可以分批处理

### 4. 支持多个工作表吗？
- 当前版本只转换第一个工作表
- 如需转换其他工作表，可先在 Excel 中调整顺序

### 5. 中文字段名会有问题吗？
- 完全支持中文字段名
- JSON 格式天然支持 Unicode

## 浏览器兼容性

### 必需功能
- File API（文件读取）
- ArrayBuffer（二进制数据）
- Clipboard API（复制功能）
- Blob API（文件下载）

### 推荐浏览器
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 注意事项

1. **数据隐私**
   - 所有处理在浏览器本地完成
   - 不会上传到服务器
   - 完全安全可靠

2. **文件大小**
   - 建议不超过 10MB
   - 数据行数不超过 10000 行
   - 过大可能导致浏览器卡顿

3. **字段名称**
   - 避免使用特殊字符
   - 中文、英文、数字均可
   - 不建议使用空格

4. **数据类型**
   - 数字自动识别为 number
   - 文本识别为 string
   - 日期建议预处理为文本格式

## 快捷键

暂无快捷键支持，后续版本可添加：
- Ctrl/Cmd + U: 上传文件
- Ctrl/Cmd + Enter: 转换
- Ctrl/Cmd + C: 复制
- Ctrl/Cmd + S: 下载

## 未来优化

- [ ] 支持多工作表选择
- [ ] 支持拖拽上传
- [ ] 添加数据过滤功能
- [ ] 支持数据排序
- [ ] 添加字段重命名
- [ ] 支持数据类型转换
- [ ] 添加空值处理选项
- [ ] 支持批量处理
- [ ] 添加数据验证
- [ ] 支持导出其他格式（CSV、XML）
- [ ] 添加数据统计分析
- [ ] 支持自定义 JSON 结构

## 相关资源

- [xlsx.js 文档](https://github.com/SheetJS/sheetjs)
- [JSON 格式规范](https://www.json.org/)
- [Excel 数据处理最佳实践](https://support.microsoft.com/excel)
